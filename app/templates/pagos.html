{% extends "base.html" %}
{% block content %}

<h2>Registrar Pago</h2>

<form method="post" action="/pagos/guardar" class="card p-3 mb-4">
  <div class="mb-3">
    <label>Cliente</label>
    <select name="cedula" class="form-control" required>
      <option value="">Seleccione cliente</option>
      {% for c in clientes %}
        <option value="{{ c['cedula'] }}">
          {{ c['nombre'] }} - {{ c['cedula'] }}
        </option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-3">
    <label>Valor</label>
    <input type="number" name="valor" class="form-control" required>
  </div>

  <div class="mb-3">
    <label>Fecha</label>
    <input type="date" name="fecha" class="form-control" required>
  </div>

  <button class="btn btn-success w-100">Guardar Pago</button>
</form>

{% if pagos and pagos|length > 0 %}
  <h4 class="mt-3">Pagos</h4>
  <div class="card p-3">
    <div class="table-responsive">
      <table class="table table-bordered mb-0">
        <thead>
          <tr>
            <th>Cliente</th>
            <th>Cédula</th>
            <th>Fecha</th>
            <th>Valor</th>
            <th>Tipo cobro</th>
            <th style="width:200px;">Acciones</th>
          </tr>
        </thead>
        <tbody>
          {% for p in pagos %}
            <tr>
              <td>{{ p['cliente'] }}</td>
              <td>{{ p['cedula'] }}</td>
              <td>{{ p['fecha'] }}</td>
              <td>{{ p['valor'] }}</td>
              <td>{{ p['tipo_cobro'] }}</td>
              <td>
                <div class="d-flex gap-2">
                  <a class="btn btn-warning btn-sm w-50" href="/pagos/editar?row_id={{ p['row_id'] }}">Editar</a>

                  <form method="post" action="/pagos/eliminar"
                        onsubmit="return confirm('¿Eliminar este pago?');"
                        style="margin:0;" class="w-50">
                    <input type="hidden" name="row_id" value="{{ p['row_id'] }}">
                    <button class="btn btn-danger btn-sm w-100">Eliminar</button>
                  </form>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endif %}

{% endblock %}
